---
import Layout from "$layouts/Layout.astro"
import BlogGrid from "$components/blog/BlogGrid.astro"
import { fetchBlogPosts } from "$lib/contentful"
import { routeSections } from "$lib/constants"
import BlogBrowserShelf from "$components/blog/BlogBrowserShelf.svelte"
import DetailHeading from "$components/DetailHeading.astro"
import BlogShowcase from "$components/blog/BlogShowcase.astro"

const posts = await fetchBlogPosts({ limit: 25 })

const [postFeaturedBig, ...postFeaturedRest] = posts
  .filter((x) => x.isFeatured === true)
  .slice(0, 4)

const {
  headings: {
    blog: { description, title }
  }
} = routeSections
---

<Layout {title} {description}>
  <DetailHeading {title} {description} />
  <div class="mx-auto max-w-screen-xl padding-width-responsive">
    <BlogBrowserShelf interactiveMode />
    <BlogShowcase {postFeaturedBig} {postFeaturedRest} />
    <BlogGrid heading="Latest posts" posts={posts.slice(0, 6)} />
  </div>
</Layout>
